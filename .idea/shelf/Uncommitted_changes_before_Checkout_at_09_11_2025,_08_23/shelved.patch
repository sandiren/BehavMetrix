Index: app/models.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from __future__ import annotations\n\nfrom datetime import datetime\nfrom typing import Optional\n\nfrom sqlalchemy import event\nfrom sqlalchemy.orm import Mapped, mapped_column, relationship\n\nfrom . import db, ma\n\n\nclass DataIngestionSession(db.Model):\n    __tablename__ = \"data_ingestion_sessions\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    created_at: Mapped[datetime] = mapped_column(default=datetime.utcnow, nullable=False)\n    created_by: Mapped[str] = mapped_column(nullable=False)\n    source: Mapped[str] = mapped_column(nullable=False)\n    notes: Mapped[Optional[str]]\n\n    animals: Mapped[list[Animal]] = relationship(\"Animal\", back_populates=\"ingestion_session\")\n\n\nclass Animal(db.Model):\n    __tablename__ = \"animals\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    persistent_id: Mapped[str] = mapped_column(unique=True, index=True)\n    name: Mapped[Optional[str]]\n    cage_id: Mapped[str] = mapped_column(index=True)\n    sex: Mapped[str]\n    age: Mapped[Optional[int]]\n    weight_kg: Mapped[Optional[float]]\n    species: Mapped[str] = mapped_column(default=\"Macaca mulatta\")\n    matriline: Mapped[Optional[str]]\n    date_of_birth: Mapped[Optional[datetime]]\n    photo_url: Mapped[Optional[str]]\n\n    ingestion_session_id: Mapped[int | None] = mapped_column(db.ForeignKey(\"data_ingestion_sessions.id\"))\n    ingestion_session: Mapped[Optional[DataIngestionSession]] = relationship(\n        \"DataIngestionSession\", back_populates=\"animals\"\n    )\n\n    behavior_logs: Mapped[list[BehaviorLog]] = relationship(\"BehaviorLog\", back_populates=\"animal\")\n    enrichment_logs: Mapped[list[EnrichmentLog]] = relationship(\"EnrichmentLog\", back_populates=\"animal\")\n    stress_logs: Mapped[list[StressLog]] = relationship(\"StressLog\", back_populates=\"animal\")\n    incidents: Mapped[list[IncidentObservation]] = relationship(\"IncidentObservation\", back_populates=\"animal\")\n\n\nclass Observer(db.Model):\n    __tablename__ = \"observers\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    affiliation: Mapped[Optional[str]]\n\n    behavior_logs: Mapped[list[BehaviorLog]] = relationship(\"BehaviorLog\", back_populates=\"observer\")\n\n\nclass BehaviorDefinition(db.Model):\n    __tablename__ = \"behavior_definitions\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    code: Mapped[str] = mapped_column(unique=True, nullable=False)\n    name: Mapped[str] = mapped_column(nullable=False)\n    description: Mapped[Optional[str]]\n    ontology_reference: Mapped[Optional[str]]\n\n    logs: Mapped[list[BehaviorLog]] = relationship(\"BehaviorLog\", back_populates=\"behavior\")\n\n\nclass BehaviorLog(db.Model):\n    __tablename__ = \"behavior_logs\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    timestamp: Mapped[datetime] = mapped_column(default=datetime.utcnow, index=True)\n    context: Mapped[Optional[str]]\n    sample_type: Mapped[str] = mapped_column(default=\"focal\")\n\n    animal_id: Mapped[int] = mapped_column(db.ForeignKey(\"animals.id\"))\n    behavior_id: Mapped[int] = mapped_column(db.ForeignKey(\"behavior_definitions.id\"))\n    observer_id: Mapped[int | None] = mapped_column(db.ForeignKey(\"observers.id\"))\n\n    animal: Mapped[Animal] = relationship(\"Animal\", back_populates=\"behavior_logs\")\n    behavior: Mapped[BehaviorDefinition] = relationship(\"BehaviorDefinition\", back_populates=\"logs\")\n    observer: Mapped[Optional[Observer]] = relationship(\"Observer\", back_populates=\"behavior_logs\")\n\n    interaction_partner_id: Mapped[int | None] = mapped_column(db.ForeignKey(\"animals.id\"))\n    interaction_partner: Mapped[Optional[Animal]] = relationship(\"Animal\", foreign_keys=[interaction_partner_id])\n\n\nclass EnrichmentItem(db.Model):\n    __tablename__ = \"enrichment_items\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str] = mapped_column(unique=True)\n    description: Mapped[Optional[str]]\n    category: Mapped[Optional[str]]\n    success_indicator: Mapped[Optional[str]]\n\n    logs: Mapped[list[EnrichmentLog]] = relationship(\"EnrichmentLog\", back_populates=\"item\")\n\n\nclass EnrichmentLog(db.Model):\n    __tablename__ = \"enrichment_logs\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    timestamp: Mapped[datetime] = mapped_column(default=datetime.utcnow)\n    duration_minutes: Mapped[Optional[float]]\n    response: Mapped[Optional[str]]\n    notes: Mapped[Optional[str]]\n    tag: Mapped[Optional[str]]\n\n    animal_id: Mapped[int] = mapped_column(db.ForeignKey(\"animals.id\"))\n    enrichment_item_id: Mapped[int] = mapped_column(db.ForeignKey(\"enrichment_items.id\"))\n\n    animal: Mapped[Animal] = relationship(\"Animal\", back_populates=\"enrichment_logs\")\n    item: Mapped[EnrichmentItem] = relationship(\"EnrichmentItem\", back_populates=\"logs\")\n\n\nclass StressLog(db.Model):\n    __tablename__ = \"stress_logs\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    date: Mapped[datetime] = mapped_column(default=datetime.utcnow, index=True)\n    stress_score: Mapped[int] = mapped_column(default=0)\n    withdrawal: Mapped[bool] = mapped_column(default=False)\n    fear_grimace: Mapped[bool] = mapped_column(default=False)\n    self_biting: Mapped[bool] = mapped_column(default=False)\n    notes: Mapped[Optional[str]]\n\n    animal_id: Mapped[int] = mapped_column(db.ForeignKey(\"animals.id\"))\n\n    animal: Mapped[Animal] = relationship(\"Animal\", back_populates=\"stress_logs\")\n\n\nclass HormoneMeasurement(db.Model):\n    __tablename__ = \"hormone_measurements\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    collected_at: Mapped[datetime] = mapped_column(default=datetime.utcnow)\n    hormone: Mapped[str] = mapped_column(default=\"cortisol\")\n    value: Mapped[float]\n    unit: Mapped[str] = mapped_column(default=\"ng/mL\")\n\n    animal_id: Mapped[int] = mapped_column(db.ForeignKey(\"animals.id\"))\n    animal: Mapped[Animal] = relationship(\"Animal\")\n\n\nclass IncidentObservation(db.Model):\n    __tablename__ = \"incident_observations\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    created_at: Mapped[datetime] = mapped_column(default=datetime.utcnow)\n    reason: Mapped[str]\n    description: Mapped[Optional[str]]\n    attachment_url: Mapped[Optional[str]]\n    tags: Mapped[Optional[str]]\n\n    animal_id: Mapped[int | None] = mapped_column(db.ForeignKey(\"animals.id\"))\n    animal: Mapped[Optional[Animal]] = relationship(\"Animal\", back_populates=\"incidents\")\n\n\nclass RankScore(db.Model):\n    __tablename__ = \"rank_scores\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    created_at: Mapped[datetime] = mapped_column(default=datetime.utcnow, nullable=False)\n    elo_score: Mapped[float] = mapped_column(default=1000.0)\n    davids_score: Mapped[Optional[float]]\n    instability_flag: Mapped[bool] = mapped_column(default=False)\n\n    animal_id: Mapped[int] = mapped_column(db.ForeignKey(\"animals.id\"), nullable=False)\n    animal: Mapped[Animal] = relationship(\"Animal\")\n\n\n@event.listens_for(BehaviorLog, \"before_insert\")\ndef set_behavior_timestamp(mapper, connection, target) -> None:  # noqa: WPS463\n    if target.timestamp is None:\n        target.timestamp = datetime.utcnow()\n\n\n@event.listens_for(EnrichmentLog, \"before_insert\")\ndef set_enrichment_timestamp(mapper, connection, target) -> None:  # noqa: WPS463\n    if target.timestamp is None:\n        target.timestamp = datetime.utcnow()\n\n\n@event.listens_for(StressLog, \"before_insert\")\ndef set_stress_date(mapper, connection, target) -> None:  # noqa: WPS463\n    if target.date is None:\n        target.date = datetime.utcnow()\n\n\nclass BehaviorLogSchema(ma.SQLAlchemySchema):\n    class Meta:\n        model = BehaviorLog\n        load_instance = True\n\n    id = ma.auto_field()\n    timestamp = ma.auto_field()\n    sample_type = ma.auto_field()\n    context = ma.auto_field()\n    animal_id = ma.auto_field()\n    behavior_id = ma.auto_field()\n    observer_id = ma.auto_field()\n\n\nclass AnimalSchema(ma.SQLAlchemySchema):\n    class Meta:\n        model = Animal\n        load_instance = True\n\n    id = ma.auto_field()\n    persistent_id = ma.auto_field()\n    name = ma.auto_field()\n    cage_id = ma.auto_field()\n    sex = ma.auto_field()\n    age = ma.auto_field()\n    weight_kg = ma.auto_field()\n    species = ma.auto_field()\n    matriline = ma.auto_field()\n    date_of_birth = ma.auto_field()\n    photo_url = ma.auto_field()\n\n\nclass EnrichmentLogSchema(ma.SQLAlchemySchema):\n    class Meta:\n        model = EnrichmentLog\n        load_instance = True\n\n    id = ma.auto_field()\n    timestamp = ma.auto_field()\n    duration_minutes = ma.auto_field()\n    response = ma.auto_field()\n    notes = ma.auto_field()\n    tag = ma.auto_field()\n    animal_id = ma.auto_field()\n    enrichment_item_id = ma.auto_field()\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/models.py b/app/models.py
--- a/app/models.py	(revision 48d496e483808f865bfa0b151b21dc5a7fbfa1be)
+++ b/app/models.py	(date 1762660057825)
@@ -1,12 +1,13 @@
 from __future__ import annotations
 
 from datetime import datetime
-from typing import Optional
+from typing import Optional, List
 
-from sqlalchemy import event
+from sqlalchemy import event, ForeignKey
 from sqlalchemy.orm import Mapped, mapped_column, relationship
 
-from . import db, ma
+from . import db
+from marshmallow_sqlalchemy import SQLAlchemyAutoSchema
 
 
 class DataIngestionSession(db.Model):
@@ -18,7 +19,7 @@
     source: Mapped[str] = mapped_column(nullable=False)
     notes: Mapped[Optional[str]]
 
-    animals: Mapped[list[Animal]] = relationship("Animal", back_populates="ingestion_session")
+    animals: Mapped[List["Animal"]] = relationship("Animal", back_populates="ingestion_session")
 
 
 class Animal(db.Model):
@@ -36,15 +37,17 @@
     date_of_birth: Mapped[Optional[datetime]]
     photo_url: Mapped[Optional[str]]
 
-    ingestion_session_id: Mapped[int | None] = mapped_column(db.ForeignKey("data_ingestion_sessions.id"))
-    ingestion_session: Mapped[Optional[DataIngestionSession]] = relationship(
-        "DataIngestionSession", back_populates="animals"
-    )
+    ingestion_session_id: Mapped[Optional[int]] = mapped_column(ForeignKey("data_ingestion_sessions.id"))
+    ingestion_session: Mapped[Optional[DataIngestionSession]] = relationship("DataIngestionSession", back_populates="animals")
 
-    behavior_logs: Mapped[list[BehaviorLog]] = relationship("BehaviorLog", back_populates="animal")
-    enrichment_logs: Mapped[list[EnrichmentLog]] = relationship("EnrichmentLog", back_populates="animal")
-    stress_logs: Mapped[list[StressLog]] = relationship("StressLog", back_populates="animal")
-    incidents: Mapped[list[IncidentObservation]] = relationship("IncidentObservation", back_populates="animal")
+    behavior_logs: Mapped[List["BehaviorLog"]] = relationship(
+        "BehaviorLog",
+        back_populates="animal",
+        foreign_keys="[BehaviorLog.animal_id]"  # resolves ambiguous FK with explicit argument
+    )
+    enrichment_logs: Mapped[List["EnrichmentLog"]] = relationship("EnrichmentLog", back_populates="animal")
+    stress_logs: Mapped[List["StressLog"]] = relationship("StressLog", back_populates="animal")
+    incidents: Mapped[List["IncidentObservation"]] = relationship("IncidentObservation", back_populates="animal")
 
 
 class Observer(db.Model):
@@ -54,7 +57,7 @@
     name: Mapped[str]
     affiliation: Mapped[Optional[str]]
 
-    behavior_logs: Mapped[list[BehaviorLog]] = relationship("BehaviorLog", back_populates="observer")
+    behavior_logs: Mapped[List["BehaviorLog"]] = relationship("BehaviorLog", back_populates="observer")
 
 
 class BehaviorDefinition(db.Model):
@@ -66,7 +69,7 @@
     description: Mapped[Optional[str]]
     ontology_reference: Mapped[Optional[str]]
 
-    logs: Mapped[list[BehaviorLog]] = relationship("BehaviorLog", back_populates="behavior")
+    logs: Mapped[List["BehaviorLog"]] = relationship("BehaviorLog", back_populates="behavior")
 
 
 class BehaviorLog(db.Model):
@@ -77,16 +80,16 @@
     context: Mapped[Optional[str]]
     sample_type: Mapped[str] = mapped_column(default="focal")
 
-    animal_id: Mapped[int] = mapped_column(db.ForeignKey("animals.id"))
-    behavior_id: Mapped[int] = mapped_column(db.ForeignKey("behavior_definitions.id"))
-    observer_id: Mapped[int | None] = mapped_column(db.ForeignKey("observers.id"))
+    animal_id: Mapped[int] = mapped_column(ForeignKey("animals.id"))
+    behavior_id: Mapped[int] = mapped_column(ForeignKey("behavior_definitions.id"))
+    observer_id: Mapped[Optional[int]] = mapped_column(ForeignKey("observers.id"))
 
-    animal: Mapped[Animal] = relationship("Animal", back_populates="behavior_logs")
-    behavior: Mapped[BehaviorDefinition] = relationship("BehaviorDefinition", back_populates="logs")
-    observer: Mapped[Optional[Observer]] = relationship("Observer", back_populates="behavior_logs")
+    animal: Mapped["Animal"] = relationship("Animal", back_populates="behavior_logs", foreign_keys=[animal_id])
+    behavior: Mapped["BehaviorDefinition"] = relationship("BehaviorDefinition", back_populates="logs")
+    observer: Mapped[Optional["Observer"]] = relationship("Observer", back_populates="behavior_logs")
 
-    interaction_partner_id: Mapped[int | None] = mapped_column(db.ForeignKey("animals.id"))
-    interaction_partner: Mapped[Optional[Animal]] = relationship("Animal", foreign_keys=[interaction_partner_id])
+    interaction_partner_id: Mapped[Optional[int]] = mapped_column(ForeignKey("animals.id"))
+    interaction_partner: Mapped[Optional["Animal"]] = relationship("Animal", foreign_keys=[interaction_partner_id])
 
 
 class EnrichmentItem(db.Model):
@@ -98,7 +101,7 @@
     category: Mapped[Optional[str]]
     success_indicator: Mapped[Optional[str]]
 
-    logs: Mapped[list[EnrichmentLog]] = relationship("EnrichmentLog", back_populates="item")
+    logs: Mapped[List["EnrichmentLog"]] = relationship("EnrichmentLog", back_populates="item")
 
 
 class EnrichmentLog(db.Model):
@@ -111,11 +114,11 @@
     notes: Mapped[Optional[str]]
     tag: Mapped[Optional[str]]
 
-    animal_id: Mapped[int] = mapped_column(db.ForeignKey("animals.id"))
-    enrichment_item_id: Mapped[int] = mapped_column(db.ForeignKey("enrichment_items.id"))
+    animal_id: Mapped[int] = mapped_column(ForeignKey("animals.id"))
+    enrichment_item_id: Mapped[int] = mapped_column(ForeignKey("enrichment_items.id"))
 
-    animal: Mapped[Animal] = relationship("Animal", back_populates="enrichment_logs")
-    item: Mapped[EnrichmentItem] = relationship("EnrichmentItem", back_populates="logs")
+    animal: Mapped["Animal"] = relationship("Animal", back_populates="enrichment_logs")
+    item: Mapped["EnrichmentItem"] = relationship("EnrichmentItem", back_populates="logs")
 
 
 class StressLog(db.Model):
@@ -129,9 +132,8 @@
     self_biting: Mapped[bool] = mapped_column(default=False)
     notes: Mapped[Optional[str]]
 
-    animal_id: Mapped[int] = mapped_column(db.ForeignKey("animals.id"))
-
-    animal: Mapped[Animal] = relationship("Animal", back_populates="stress_logs")
+    animal_id: Mapped[int] = mapped_column(ForeignKey("animals.id"))
+    animal: Mapped["Animal"] = relationship("Animal", back_populates="stress_logs")
 
 
 class HormoneMeasurement(db.Model):
@@ -143,8 +145,8 @@
     value: Mapped[float]
     unit: Mapped[str] = mapped_column(default="ng/mL")
 
-    animal_id: Mapped[int] = mapped_column(db.ForeignKey("animals.id"))
-    animal: Mapped[Animal] = relationship("Animal")
+    animal_id: Mapped[int] = mapped_column(ForeignKey("animals.id"))
+    animal: Mapped["Animal"] = relationship("Animal")
 
 
 class IncidentObservation(db.Model):
@@ -157,8 +159,8 @@
     attachment_url: Mapped[Optional[str]]
     tags: Mapped[Optional[str]]
 
-    animal_id: Mapped[int | None] = mapped_column(db.ForeignKey("animals.id"))
-    animal: Mapped[Optional[Animal]] = relationship("Animal", back_populates="incidents")
+    animal_id: Mapped[Optional[int]] = mapped_column(ForeignKey("animals.id"))
+    animal: Mapped[Optional["Animal"]] = relationship("Animal", back_populates="incidents")
 
 
 class RankScore(db.Model):
@@ -170,70 +172,40 @@
     davids_score: Mapped[Optional[float]]
     instability_flag: Mapped[bool] = mapped_column(default=False)
 
-    animal_id: Mapped[int] = mapped_column(db.ForeignKey("animals.id"), nullable=False)
-    animal: Mapped[Animal] = relationship("Animal")
+    animal_id: Mapped[int] = mapped_column(ForeignKey("animals.id"), nullable=False)
+    animal: Mapped["Animal"] = relationship("Animal")
 
-
+# Event listeners
 @event.listens_for(BehaviorLog, "before_insert")
-def set_behavior_timestamp(mapper, connection, target) -> None:  # noqa: WPS463
+def set_behavior_timestamp(mapper, connection, target) -> None:
     if target.timestamp is None:
         target.timestamp = datetime.utcnow()
 
-
 @event.listens_for(EnrichmentLog, "before_insert")
-def set_enrichment_timestamp(mapper, connection, target) -> None:  # noqa: WPS463
+def set_enrichment_timestamp(mapper, connection, target) -> None:
     if target.timestamp is None:
         target.timestamp = datetime.utcnow()
 
-
 @event.listens_for(StressLog, "before_insert")
-def set_stress_date(mapper, connection, target) -> None:  # noqa: WPS463
+def set_stress_date(mapper, connection, target) -> None:
     if target.date is None:
         target.date = datetime.utcnow()
 
-
-class BehaviorLogSchema(ma.SQLAlchemySchema):
+# SCHEMAS
+class BehaviorLogSchema(SQLAlchemyAutoSchema):
     class Meta:
         model = BehaviorLog
+        include_fk = True
         load_instance = True
 
-    id = ma.auto_field()
-    timestamp = ma.auto_field()
-    sample_type = ma.auto_field()
-    context = ma.auto_field()
-    animal_id = ma.auto_field()
-    behavior_id = ma.auto_field()
-    observer_id = ma.auto_field()
-
-
-class AnimalSchema(ma.SQLAlchemySchema):
+class AnimalSchema(SQLAlchemyAutoSchema):
     class Meta:
         model = Animal
+        include_fk = True
         load_instance = True
 
-    id = ma.auto_field()
-    persistent_id = ma.auto_field()
-    name = ma.auto_field()
-    cage_id = ma.auto_field()
-    sex = ma.auto_field()
-    age = ma.auto_field()
-    weight_kg = ma.auto_field()
-    species = ma.auto_field()
-    matriline = ma.auto_field()
-    date_of_birth = ma.auto_field()
-    photo_url = ma.auto_field()
-
-
-class EnrichmentLogSchema(ma.SQLAlchemySchema):
+class EnrichmentLogSchema(SQLAlchemyAutoSchema):
     class Meta:
         model = EnrichmentLog
+        include_fk = True
         load_instance = True
-
-    id = ma.auto_field()
-    timestamp = ma.auto_field()
-    duration_minutes = ma.auto_field()
-    response = ma.auto_field()
-    notes = ma.auto_field()
-    tag = ma.auto_field()
-    animal_id = ma.auto_field()
-    enrichment_item_id = ma.auto_field()
Index: requirements.txt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>Flask==3.0.3\nFlask-SQLAlchemy==3.1.1\nFlask-Migrate==4.0.7\nFlask-Marshmallow==1.2.1\nmarshmallow-sqlalchemy==0.29.0\npandas==2.2.2\nopenpyxl==3.1.5\nfaker==19.13.0\nnetworkx==3.2.1\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/requirements.txt b/requirements.txt
--- a/requirements.txt	(revision 48d496e483808f865bfa0b151b21dc5a7fbfa1be)
+++ b/requirements.txt	(date 1762660057860)
@@ -1,9 +1,12 @@
 Flask==3.0.3
-Flask-SQLAlchemy==3.1.1
-Flask-Migrate==4.0.7
-Flask-Marshmallow==1.2.1
+Flask-SQLAlchemy
+Flask_Migrate
+
 marshmallow-sqlalchemy==0.29.0
 pandas==2.2.2
 openpyxl==3.1.5
 faker==19.13.0
 networkx==3.2.1
+
+flask_marshmallow>=0.15.0
+marshmallow==3.19.0
\ No newline at end of file
Index: README.md
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+># \uD83E\uDDE0 BehavMetrix: Behavioral Welfare Analytics for Primate Colonies\n\nBehavMetrix is a FAIR-compliant Flask web application that enables animal care teams to log, analyze, and share welfare insights for large outdoor macaque colonies (up to 80 animals). The platform focuses on reproducible behavioral data capture, transparent metadata, and interoperable exports so that labs can collaborate around shared ethograms and enrichment outcomes.\n\n---\n\n## âœ¨ Key Modules\n\n- **Data Ingestion** â€“ Upload CSV/Excel sheets or stream SQL tables. Required fields (Animal ID, Cage ID, Sex, Age, Weight) are validated and every import generates provenance metadata (user, timestamp, source, notes).\n- **Colony Dashboard** â€“ Tablet-friendly dashboard with animal profile cards (stress score, weight, enrichment use, rank) and colony-level summaries (grooming %, aggression, play). Rank instability is visualized through an interactive network graph.\n- **Behavior Logging** â€“ Ontology-aligned macaque ethogram buttons for grooming, aggression, play, pacing, and SDBs. Supports scan samples and focal follows tied to animal IDs with observer metadata.\n- **Social Ranking System** â€“ Calculates Elo scores from interaction logs, surfaces potential instability, and links rank values back to timestamped behavior events.\n- **Enrichment Tracker** â€“ Logs enrichment inventory usage (item, duration, response, success tag) and tracks correlations with stress/SDB reduction.\n- **Stress Monitor** â€“ Daily logging of stress indicators (withdrawal, fear grimace, self-biting) with linkage to behavior and hormone measurements.\n- **Incident & Observation Tracker** â€“ Capture ad-hoc notes, attach media links, and assign FAIR tags to incidents or enrichment trials.\n- **Exports & API** â€“ Download CSV/JSON/Excel snapshots with full metadata or integrate via REST endpoints for animals, behaviors, and enrichment logs.\n\n---\n\n## \uD83D\uDDC2\uFE0F Project Structure\n\n```\nBehavMetrix/\nâ”œâ”€â”€ app/\nâ”‚   â”œâ”€â”€ __init__.py            # Flask app factory, extensions, CLI\nâ”‚   â”œâ”€â”€ api.py                 # REST API blueprint\nâ”‚   â”œâ”€â”€ models.py              # SQLAlchemy models & Marshmallow schemas\nâ”‚   â”œâ”€â”€ mock_data.py           # Faker-powered mock dataset generator\nâ”‚   â”œâ”€â”€ routes.py              # Web routes and dashboard logic\nâ”‚   â”œâ”€â”€ utils/\nâ”‚   â”‚   â”œâ”€â”€ analytics.py       # Elo ranking, colony stats helpers\nâ”‚   â”‚   â””â”€â”€ ingestion.py       # FAIR data ingestion helpers\nâ”‚   â”œâ”€â”€ templates/             # Bootstrap/Jinja2 UI\nâ”‚   â””â”€â”€ static/                # Styles and assets\nâ”œâ”€â”€ behavmetrix.py             # WSGI/CLI entry point\nâ”œâ”€â”€ requirements.txt           # Python dependencies\nâ””â”€â”€ README.md\n```\n\n---\n\n## \uD83D\uDE80 Getting Started\n\n```bash\npython -m venv .venv\nsource .venv/bin/activate\npip install -r requirements.txt\nexport FLASK_APP=behavmetrix.py\nflask --app behavmetrix.py db upgrade  # if migrations configured\nflask --app behavmetrix.py create-mock-data\nflask --app behavmetrix.py run\n```\n\nVisit `http://127.0.0.1:5000/` for the dashboard.\n\n> **Note:** The scaffold ships with mock data so you can explore dashboards without instrumentation. Replace the dataset using the ingestion module to load your colony records.\n\n---\n\n## \uD83D\uDCC4 FAIR & Compliance Considerations\n\n- **Findable:** Global search/filter fields, persistent IDs, and ranked exports ensure that animals and events are discoverable.\n- **Accessible:** REST API endpoints (`/api/animals`, `/api/behaviors`, `/api/enrichment`) return JSON structures compatible with downstream tools.\n- **Interoperable:** Behavior definitions align with NC3Rs/NBO ontology codes; exports include schema-complete metadata for reuse by partner labs.\n- **Reusable:** MIT-licensed code and CC-BY recommended for exported datasets. Documentation describes behavior definitions, scoring logic, and enrichment success criteria.\n\n---\n\n## \uD83D\uDCDA Additional Notes\n\n- Configure `DATABASE_URL` to switch from SQLite to PostgreSQL or MySQL.\n- Extend `app/utils/ingestion.py` to connect directly to lab SQL servers.\n- Use the `/behavior-log` module during focal follows; `/enrichment` for enrichment trials; `/stress` to capture daily welfare scores; `/incident` for ad-hoc notes.\n- Customize the ethogram by editing `BEHAVIOR_DEFINITIONS` in `app/mock_data.py` and inserting additional `BehaviorDefinition` rows via ingestion or migrations.\n\n---\n\n## \uD83D\uDCDC License\n\n- **Code:** MIT License (see `LICENSE` once added).\n- **Data Outputs:** Recommend CC-BY 4.0 for shared exports.\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/README.md b/README.md
--- a/README.md	(revision 48d496e483808f865bfa0b151b21dc5a7fbfa1be)
+++ b/README.md	(date 1762660057884)
@@ -41,17 +41,64 @@
 
 ## ðŸš€ Getting Started
 
-```bash
+
+### 1. **Clone the repository**
+
+git clone https://github.com/your_username/BehavMetrix.git
+cd BehavMetrix
+
+text
+
+### 2. **Setup Python Virtual Environment**
+
 python -m venv .venv
 source .venv/bin/activate
+
+
+### 3. **Install Python Dependencies**
+
+pip install --upgrade pip
 pip install -r requirements.txt
+
+
+### 4. **Initialize the Database**
+
+If this is your first time (using SQLite by default):
+
+In Python shell:
+from app import db, create_app
+app = create_app()
+with app.app_context():
+db.create_all()
+exit()
+
+text
+Or, with Flask CLI:
 export FLASK_APP=behavmetrix.py
-flask --app behavmetrix.py db upgrade  # if migrations configured
+flask shell
+
+In shell:
+from app import db
+db.create_all()
+exit()
+
+
+If using Flask-Migrate (optional for migrations):
+flask db init
+flask db migrate -m "init"
+flask db upgrade
+
+
+### 5. **Generate Mock Data (Optional)**
 flask --app behavmetrix.py create-mock-data
+
+text
+
+### 6. **Run the App**
 flask --app behavmetrix.py run
-```
 
-Visit `http://127.0.0.1:5000/` for the dashboard.
+text
+Visit [http://127.0.0.1:5000/](http://127.0.0.1:5000/) for the dashboard.
 
 > **Note:** The scaffold ships with mock data so you can explore dashboards without instrumentation. Replace the dataset using the ingestion module to load your colony records.
 
Index: .gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.gitignore b/.gitignore
new file mode 100644
--- /dev/null	(date 1762660057914)
+++ b/.gitignore	(date 1762660057914)
@@ -0,0 +1,164 @@
+### Python template
+# Byte-compiled / optimized / DLL files
+__pycache__/
+*.py[cod]
+*$py.class
+
+# C extensions
+*.so
+
+# Distribution / packaging
+.Python
+build/
+develop-eggs/
+dist/
+downloads/
+eggs/
+.eggs/
+lib/
+lib64/
+parts/
+sdist/
+var/
+wheels/
+share/python-wheels/
+*.egg-info/
+.installed.cfg
+*.egg
+MANIFEST
+
+# PyInstaller
+#  Usually these files are written by a python script from a template
+#  before PyInstaller builds the exe, so as to inject date/other infos into it.
+*.manifest
+*.spec
+
+# Installer logs
+pip-log.txt
+pip-delete-this-directory.txt
+
+# Unit test / coverage reports
+htmlcov/
+.tox/
+.nox/
+.coverage
+.coverage.*
+.cache
+nosetests.xml
+coverage.xml
+*.cover
+*.py,cover
+.hypothesis/
+.pytest_cache/
+cover/
+
+# Translations
+*.mo
+*.pot
+
+# Django stuff:
+*.log
+local_settings.py
+db.sqlite3
+db.sqlite3-journal
+
+# Flask stuff:
+instance/
+.webassets-cache
+
+# Scrapy stuff:
+.scrapy
+
+# Sphinx documentation
+docs/_build/
+
+# PyBuilder
+.pybuilder/
+target/
+
+# Jupyter Notebook
+.ipynb_checkpoints
+
+# IPython
+profile_default/
+ipython_config.py
+
+# pyenv
+#   For a library or package, you might want to ignore these files since the code is
+#   intended to run in multiple environments; otherwise, check them in:
+# .python-version
+
+# pipenv
+#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.
+#   However, in case of collaboration, if having platform-specific dependencies or dependencies
+#   having no cross-platform support, pipenv may install dependencies that don't work, or not
+#   install all needed dependencies.
+#Pipfile.lock
+
+# poetry
+#   Similar to Pipfile.lock, it is generally recommended to include poetry.lock in version control.
+#   This is especially recommended for binary packages to ensure reproducibility, and is more
+#   commonly ignored for libraries.
+#   https://python-poetry.org/docs/basic-usage/#commit-your-poetrylock-file-to-version-control
+#poetry.lock
+
+# pdm
+#   Similar to Pipfile.lock, it is generally recommended to include pdm.lock in version control.
+#pdm.lock
+#   pdm stores project-wide configurations in .pdm.toml, but it is recommended to not include it
+#   in version control.
+#   https://pdm.fming.dev/latest/usage/project/#working-with-version-control
+.pdm.toml
+.pdm-python
+.pdm-build/
+
+# PEP 582; used by e.g. github.com/David-OConnor/pyflow and github.com/pdm-project/pdm
+__pypackages__/
+
+# Celery stuff
+celerybeat-schedule
+celerybeat.pid
+
+# SageMath parsed files
+*.sage.py
+
+# Environments
+.env
+.venv
+env/
+venv/
+ENV/
+env.bak/
+venv.bak/
+
+# Spyder project settings
+.spyderproject
+.spyproject
+
+# Rope project settings
+.ropeproject
+
+# mkdocs documentation
+/site
+
+# mypy
+.mypy_cache/
+.dmypy.json
+dmypy.json
+
+# Pyre type checker
+.pyre/
+
+# pytype static type analyzer
+.pytype/
+
+# Cython debug symbols
+cython_debug/
+
+# PyCharm
+#  JetBrains specific template is maintained in a separate JetBrains.gitignore that can
+#  be found at https://github.com/github/gitignore/blob/main/Global/JetBrains.gitignore
+#  and can be added to the global gitignore or merged into this file.  For a more nuclear
+#  option (not recommended) you can uncomment the following to ignore the entire idea folder.
+#.idea/
+
